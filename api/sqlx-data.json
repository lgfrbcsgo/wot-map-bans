{
  "db": "PostgreSQL",
  "034bb8e59fea66cec1dc2770d1ad68a4bad955cc140f94abf495589dfe0ae7cf": {
    "describe": {
      "columns": [
        {
          "name": "time",
          "ordinal": 0,
          "type_info": "Timestamptz"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Int4",
          "Text",
          "Text",
          "Text",
          "Int2",
          "Int2"
        ]
      }
    },
    "query": "INSERT INTO played_map(player_id, server_id, map_id, mode_id, bottom_tier, top_tier)\nSELECT $1, server.id, map.id, mode.id, $5, $6\nFROM server, map, mode\nWHERE server.name = $2 AND map.code = $3 AND mode.code = $4\nRETURNING played_map.time;"
  },
  "a104214113db159624d067d83946b84e80123ec2215de19c90039282f91844b5": {
    "describe": {
      "columns": [
        {
          "name": "map",
          "ordinal": 0,
          "type_info": "Text"
        },
        {
          "name": "mode",
          "ordinal": 1,
          "type_info": "Text"
        },
        {
          "name": "count",
          "ordinal": 2,
          "type_info": "Int8"
        }
      ],
      "nullable": [
        false,
        false,
        null
      ],
      "parameters": {
        "Left": [
          "Text",
          "Int2",
          "Int2"
        ]
      }
    },
    "query": "WITH current_map AS (\n  SELECT map_id, mode_id, count(DISTINCT player_id) as count\n  FROM played_map\n  WHERE server_id = (SELECT id FROM server WHERE name = $1)\n    AND $2 <= top_tier\n    AND bottom_tier <= $3\n    AND time > now() - INTERVAL '1 hour'\n  GROUP BY map_id, mode_id\n)\nSELECT map.code as map, mode.code as mode, current_map.count\nFROM current_map\n  INNER JOIN mode ON current_map.mode_id = mode.id\n  INNER JOIN map ON current_map.map_id = map.id;\n"
  }
}